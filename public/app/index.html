<!DOCTYPE html>

<html ng-app="stldApp">
  <head>
    <link href="/styles/vendor/bootstrap.no-icons.min.css" rel="stylesheet">
    <link href="/styles/vendor/font-awesome/font-awesome.min.css" rel="stylesheet">
    <link href="/styles/application.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>

  <body class="container" ng-controller="TaskCtrl">

<!--HEADER ------------------------------------------------ -->

    <header class="navbar-fixed-top navbar">
      <nav class="navbar navbar-default" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <a class="navbar-brand" href="/">STLD!</a>
          </div>
            <ul class="nav navbar-nav">
              <li ng-class="{active: taskFilter == 'thisWeek'}"><a href="#" ng-click="setFilter('thisWeek')">this week</a></li>
              <li ng-class="{active: taskFilter == 'backlog'}"><a href="#" ng-click="setFilter('backlog')">backlog</a></li>
            </ul>
        </div>
      </nav>
    </header>

<!--START NEW SPRINT --------------------- -->

    <section>
      <form action="/start_new_sprint", method="post">
        <button class="btn btn-default btn-lg" id="start-sprint-btn">Start new sprint <i class="fa fa-angle-double-right"></i></button>
      </form>
    </section>

<!--ALERTS -->

    <section>
      <div ng-repeat="alert in alerts" class="alert alert-danger">
        <button type="button" class="close close-alert" aria-hidden="true" ng-click="removeAlert(alert)">&times;</button>
        {{alert.message}}
      </div>
    </section>

<!--UNIQUE TASKS ------------------------------------------------ -->

    <section id="unique-tasks">
      <div class="panel panel-default">
        <div class="panel-heading task-heading">
          <h3>Unique tasks <a href="#" ng-click="toggleDisplay('unique')"><i class="btn-expand fa" ng-class="tasksDisplayed | expandClass:'unique'"></i></a></h3>
        </div>
        <table class="table tasks table-hover" ng-show="tasksDisplayed.unique">
          <tbody>
            <tr class="unique-task" ng-repeat="task in uniqueTasks | filter: filterTask()">
              <td ng-show="task.mode == 'show'">{{ task.description }}</td>
              <td ng-show="task.mode == 'edit'">
                <form id="uq-edit-form" role="form" ng-submit="updateUniqueTaskDescription(task)">
                  <div class="input-group">
                    <input type="text" class="form-control" name="uq-description" ng-model="task.tempDescription">
                    <span class="input-group-btn">
                      <button type="submit" class="btn btn-default">OK</button>
                      <button type="button" class="btn btn-default" ng-click="task.cancelEdit()">Cancel</button>
                    </span>
                  </div>
                </form>
              </td>
              <td class="task-btn"><button type="button" class="btn btn-success" ng-click="deleteUniqueTask(task)" ng-show="task.mode == 'show'" id="uq-done"><i class="fa fa-check"></i> Done</button></td>
              <td class="task-btn"><button type="button" class="btn btn-default" ng-show="task.mode == 'show'" ng-click="toggleActivity(task)">{{ task.displayAction() }}</button></td>
              <td class="task-btn"><button ng-show="task.mode == 'show'" type="button" class="btn btn-info" id="uq-edit" ng-click="task.addEditMode()"><i class="fa fa-pencil"></i> Edit</button></td>
              <td class="task-btn"><button type="button" class="btn btn-danger" ng-show="task.mode == 'show'" ng-click="deleteUniqueTask(task)" class="btn btn-danger"><i class="fa fa-times"></i> Delete</button></td>
            </tr>
            <tr>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- CREATE UNIQUE TASK-->

      <button class="btn btn-default" id='uq-create' ng-click="toggleCreateMode('unique')" ng-show="!createMode['unique']"><i class="fa fa-plus"></i> Create</button>
      <form role="form" id="uq-create-form" ng-show="createMode['unique']" ng-submit="createUniqueTask(newTaskDescription)">
        <div class="input-group">
          <input name='uq-description' type="text" class="form-control" ng-model="newTaskDescription">
          <span class="input-group-btn">
             <button type="submit" class="btn btn-default">OK</button>
             <button type="button" class="btn btn-default" ng-click="toggleCreateMode('unique')">Cancel</button> </span>
        </div>
      </form>
    </section>

<!--RECURRING TASKS ------------------------------------------------ -->

    <section id="recurring-tasks">
      <div class="panel panel-default">
        <div class="panel-heading task-heading"><h3>Recurring tasks <a href="#" ng-click="toggleDisplay('recurring')"><i class="btn-expand fa" ng-class="tasksDisplayed | expandClass:'recurring'"></i></a></h3></div>
        <table class="table tasks table-hover" ng-show="tasksDisplayed.recurring">
          <tbody>
            <tr class="recurring-task" ng-repeat="task in recurringTasks | filter: filterTask()">
              <td ng-show="task.mode == 'show'">
                {{ task.description }}</br>
                <small>every {{task.frequency}} week(s)</small>
              </td>
              <td ng-show="task.mode == 'edit'">
                <form id="rec-edit-form" role="form" ng-submit="updateRecTask(task)">
                  <div class="input-group">
                    <input name="rec-description" type="text" class="form-control" ng-model="task.tempDescription">
                    <span class="input-group-addon">
                      Repeat every
                      <select ng-model="task.tempFrequency" name="rec-frequency">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                        <option>6</option>
                      </select>
                      week(s)
                    </span>
                    <span class="input-group-btn">
                      <button type="submit" class="btn btn-default">OK</button>
                      <button type="button" class="btn btn-default" ng-click="task.cancelEdit()">Cancel</button>
                    </span>
                  </div>
                </form>
              </td>
              <td class="task-btn"><button ng-show="task.mode == 'show'" type="button" ng-click="deleteRecurringTask(task)" class="btn btn-success" id="yellow"><i class="fa fa-check"></i> Done</button></td>
              <td class="task-btn"><button ng-show="task.mode == 'show'" type="button" class="btn btn-default">{{ task.displayAction() }}</button></td>
              <td class="task-btn"><button ng-show="task.mode == 'show'" type="button" id="rec-edit" class="btn btn-info" ng-click="task.addEditMode()"><i class="fa fa-pencil"></i> Edit</button></td>
              <td class="task-btn"><button ng-show="task.mode == 'show'" type="button" ng-click="deleteRecurringTask(task)" class="btn btn-danger" id="rec-delete"><i class="fa fa-times"></i> Delete</button></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- CREATE RECURRING TASK-->

      <button class="btn btn-default btn-recurring" ng-click="toggleCreateMode('recurring')" ng-show="!createMode['recurring']" id="rec-create"><i class="fa fa-plus"></i> Create</button>
      <form role="form" ng-show="createMode['recurring']" ng-submit="createRecurringTask(newTaskDescription, newTaskEnabled, newTaskFrequency)" id="rec-create-form">
        <div class="input-group">
          <input type="text" class="form-control" ng-model="newTaskDescription" name="rec-description">
          <span class="input-group-addon">
            <input type="checkbox" ng-model="newTaskEnabled" name="rec-enabled"> Enable?</input>
          </span>
          <span class="input-group-addon">
            Repeat every
            <select ng-model="newTaskFrequency" name="rec-frequency">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
              <option>6</option>
            </select>
            week(s)
          </span>
          <span class="input-group-btn">
             <button type="submit" class="btn btn-default">OK</button>
             <button type="button" class="btn btn-default" ng-click="toggleCreateMode('recurring')">Cancel</button>
          </span>
        </div>
      </form>
    </section>


<!--SCRIPTS -->
    <script src="/scripts/vendor/angular.min.js"></script>
    <script src="/scripts/filters/stldAppFilters.js"></script>
    <script src="/scripts/services/taskService.js"></script>
    <script src="/scripts/app.js"></script>
  </body>
</html>
